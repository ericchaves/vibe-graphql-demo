# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

### Changed

### Deprecated

### Removed

### Fixed

### Security

## [stage-10.0] - 2025-05-08

### Added
- Added `between` and `notBetween` operators to `IntFilterInput` and `DateTimeFilterInput` in `schema.py`.
- Added `AND` and `OR` logical operators to `VisitaFilterInput` in `schema.py` for combining filters.
- Added new unit tests in `tests/test_query_builder.py` for `BETWEEN`, `NOT BETWEEN`, `AND`, `OR`, and nested logic.
- Added new integration tests in `tests/test_graphql_api.py` for the new filter functionalities.

### Changed
- Refactored `build_where_clause` function in `schema.py` to use a recursive approach (`_build_clause_recursively`) for handling complex filter logic and operator precedence.
- Updated `README.md` with examples for all supported filter operations, including `BETWEEN`, `NOT BETWEEN`, `AND`, and `OR`.

### Fixed
- Adjusted assertions in `tests/test_query_builder.py` to match the actual SQL parenthesis structure generated by the refactored `build_where_clause`, ensuring all tests pass.

## [stage-9.0] - 2025-05-08

### Added
- Created `Makefile` with targets for `test` (run tests), `run-server` (initialize DB, seed data, run server), and `clean` (Etapa 9).
- Updated `tasks.md` and `changelog.md` to reflect completion of Etapa 9.
- Corrected `Makefile` `run-server` target to use `python -m uvicorn main:app --reload`.

### Changed
- Updated `.clinerules/project_workflow.md` and `README.md` to reflect hybrid dependency management (pip in devcontainer, uv on host).
- Revised `Makefile` to conditionally activate virtual environment.

### Fixed
- Corrected table alias usage in `tests/test_query_builder.py` assertions.
- Corrected timestamp parsing in `tests/test_graphql_api.py`.

## [stage-7.0] - 2025-05-08

### Added
- Initial project setup and configuration (Etapa 0).
- Database modeling and creation script (Etapa 1).
- Defined GraphQL types with Strawberry (Etapa 2), including consolidated `VisitaType` and `InputFilter` types.
- Implemented GraphQL resolvers (Etapa 3), including database interaction and dynamic query building with filters.
- Created script for generating and inserting example data (Etapa 4).
- Implemented backend filtering logic (Etapa 5), translating InputFilters to SQL WHERE clauses.
- Added unit and integration tests (Etapa 6) for query building and GraphQL API.
- Completed final documentation (Etapa 7), including expanded README and API documentation.
